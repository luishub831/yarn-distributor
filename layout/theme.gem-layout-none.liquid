{% comment %}
	GEMPAGE BUILDER (https://apps.shopify.com/gempage)

	You SHOULD NOT modify source code in this page because
	It is automatically generated from GEMPAGE BUILDER
	Try to edit page with the live editor.
{% endcomment %}
<!doctype html>
<html class='no-js' lang='{{ request.locale.iso_code }}'>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width,initial-scale=1'>
    <meta name='theme-color' content='{{ settings.default_color_scheme }}'>
    {%- if page_description -%}
      <meta name='description' content='{{ page_description | escape }}'>
    {%- endif -%}
    {%- if settings.favicon != blank -%}
      <link rel='icon' type='image/png' href='{{ settings.favicon | image_url: width: 32, height: 32 }}'>
    {%- endif -%}
    {% render 'meta-tags' %}
    <link rel='canonical' href='{{ canonical_url }}'>
    <link rel='preconnect' href='https://cdn.shopify.com' crossorigin>
    <link rel='preconnect' href='https://fonts.shopifycdn.com' crossorigin>

    <title>
      {{ page_title }}
      {%- if current_tags %}
        &ndash; tagged "{{ current_tags | join: ', ' }}"
      {%- endif -%}
      {%- if current_page != 1 %} &ndash; Page {{ current_page }}{% endif -%}
      {%- unless page_title contains shop.name %}
        &ndash; {{ shop.name -}}
      {%- endunless -%}
    </title>

    {% render 'css-variables' %}
    {{ 'index.js' | asset_url | preload_tag: as: 'script' }}
    {{ 'index.css' | asset_url | stylesheet_tag: preload: true }}
    {% render 'fonts' %}
    {{ content_for_header }}
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js" defer></script>
   <script>
      (function(h,o,t,j,a,r){
          h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
          h._hjSettings={hjid:3916316,hjsv:6};
          a=o.getElementsByTagName('head')[0];
          r=o.createElement('script');r.async=1;
          r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
          a.appendChild(r);
      })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
  </script>
  </head>
  <body>
<div class="gem-container">
	{{ content_for_layout }}
</div><!-- end .gem-container --><!--Gem_Page_Footer_Script-->
  {%- liquid
    assign gpTemplateSuffix = template.suffix
    assign arrSplitSuffix = gpTemplateSuffix | split: '-'
    if gpTemplateSuffix contains 'gem-' and gpTemplateSuffix contains '-template' and arrSplitSuffix.size == 3
      assign isV6GpTemplate = true
    endif
    assign gpShopMeta = shop.metafields.gempages
    if gpShopMeta
      if gpShopMeta['productV6-default'] == 'true' and request.page_type == 'product'
        assign isProductDefault = true
      endif
      if gpShopMeta['collectionV6-default'] == 'true' and request.page_type == 'collection'
        assign isCollectionDefault = true
      endif
      if gpShopMeta['indexV6-default'] == 'true' and request.page_type == 'index'
        assign isIndexDefault = true
      endif
      if isProductDefault or isCollectionDefault or isIndexDefault or isPreviewV6
        assign isV6GpTemplate = true
      endif
    endif
  %}
  {% if isV6GpTemplate %}
    {% render 'gem-app-footer-scripts', GEM_FOOTER_SCRIPT: GEM_FOOTER_SCRIPT %}
  {% endif %}
<!--End_Gem_Page_Footer_Script-->
</body>
</html>

<script>
    // setTimeout(() => {
    //   let button = document.querySelector('product-form .product-form__btns [type="submit"]')
    //   if(button) {
    //       button.addEventListener("click", () => {
    //           setTimeout(() => {
    //               BSS_B2B.handleCartCheckoutBtn(JSON.parse($('#bss-b2b-store-data').html()))
    //           }, 2000)
    //       })
    //   }
    // }, 1000)
  const fixMiniCart = () =>{
   console.log("BSS fix mini cart")
    setTimeout(()=>{
      BSS_B2B.handleCartCheckoutBtn(JSON.parse($('#bss-b2b-store-data').html()), false, false)
      BSS_B2B.cart.fixer(JSON.parse($('#bss-b2b-store-data').html()), false, false)
     },1000)
  }
  const fixCart = () =>{
    const targetNode = document.querySelector("[data-cart-page-items]");
    const config = { attributes: true, childList: true, subtree: true };
    const callback = (mutationList, observer) => {
      for (const mutation of mutationList) {
        if(mutation.target.classList.contains("cart-item__totals")){
            BSS_B2B.cart.fixer(JSON.parse($('#bss-b2b-store-data').html()), false, false)
        }
      }
    };
    const observer = new MutationObserver(callback);
    observer.observe(targetNode, config);
  }
  if (typeof BSS_B2B !== 'undefined') {
    if (window.location.pathname === '/cart') {
      fixCart()
    }
  }
</script>
